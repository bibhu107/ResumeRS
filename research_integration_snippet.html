<!-- Research Papers Search Integration Snippet -->
<!-- Add this to your existing HTML file -->

<style>
/* Add these styles to your existing CSS */
.research-search-widget {
    background: var(--bg-secondary);
    padding: 25px;
    border-radius: 12px;
    margin-bottom: 30px;
    border: 1px solid var(--border-color);
}

.search-box {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.search-input {
    flex: 1;
    padding: 10px 15px;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    font-size: 0.9rem;
}

.search-btn {
    padding: 10px 20px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.9rem;
}

.api-tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 15px;
    flex-wrap: wrap;
}

.api-tab {
    padding: 6px 12px;
    background: white;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: all 0.3s ease;
}

.api-tab.active {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.search-results {
    max-height: 400px;
    overflow-y: auto;
}

.result-item {
    background: white;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 10px;
    border-left: 3px solid var(--accent-color);
    box-shadow: var(--shadow-sm);
}

.result-title {
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 5px;
    font-size: 0.95rem;
}

.result-authors {
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin-bottom: 5px;
}

.result-journal {
    color: var(--primary-color);
    font-style: italic;
    font-size: 0.85rem;
    margin-bottom: 8px;
}

.result-links {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.result-link {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    background: var(--bg-secondary);
    color: var(--primary-color);
    text-decoration: none;
    border-radius: 4px;
    font-size: 0.75rem;
    transition: all 0.3s ease;
}

.result-link:hover {
    background: var(--primary-color);
    color: white;
}
</style>

<!-- HTML Structure to add to your publications section -->
<div class="research-search-widget">
    <h3 style="margin-bottom: 15px; color: var(--primary-color);">
        <i class="fas fa-search"></i> Search Research Papers
    </h3>
    
    <div class="api-tabs">
        <button class="api-tab active" data-api="arxiv">arXiv</button>
        <button class="api-tab" data-api="crossref">CrossRef</button>
        <button class="api-tab" data-api="semantic">Semantic Scholar</button>
    </div>
    
    <div class="search-box">
        <input type="text" class="search-input" placeholder="Search for research papers..." id="paperSearchInput">
        <button class="search-btn" onclick="searchResearchPapers()">
            <i class="fas fa-search"></i> Search
        </button>
    </div>
    
    <div class="search-results" id="paperSearchResults" style="display: none;"></div>
</div>

<script>
// Research Papers Search Functionality
let currentSearchAPI = 'arxiv';

// API tab switching
document.querySelectorAll('.api-tab').forEach(tab => {
    tab.addEventListener('click', function() {
        document.querySelectorAll('.api-tab').forEach(t => t.classList.remove('active'));
        this.classList.add('active');
        currentSearchAPI = this.dataset.api;
    });
});

// Search function
async function searchResearchPapers() {
    const query = document.getElementById('paperSearchInput').value.trim();
    const resultsDiv = document.getElementById('paperSearchResults');
    
    if (!query) {
        alert('Please enter a search term');
        return;
    }
    
    resultsDiv.style.display = 'block';
    resultsDiv.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-secondary);"><i class="fas fa-spinner fa-spin"></i> Searching...</div>';
    
    try {
        let results = [];
        
        switch(currentSearchAPI) {
            case 'arxiv':
                results = await searchArxivAPI(query);
                break;
            case 'crossref':
                results = await searchCrossRefAPI(query);
                break;
            case 'semantic':
                results = await searchSemanticScholarAPI(query);
                break;
        }
        
        displaySearchResults(results);
        
    } catch (error) {
        console.error('Search error:', error);
        resultsDiv.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-secondary);">Search failed. Please try again.</div>';
    }
}

// arXiv API search
async function searchArxivAPI(query) {
    const url = `https://export.arxiv.org/api/query?search_query=all:${encodeURIComponent(query)}&start=0&max_results=10`;
    
    try {
        const response = await fetch(url);
        const xmlText = await response.text();
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
        
        const entries = xmlDoc.querySelectorAll('entry');
        const results = [];
        
        entries.forEach(entry => {
            const title = entry.querySelector('title')?.textContent?.trim();
            const authors = Array.from(entry.querySelectorAll('author name')).map(author => author.textContent);
            const published = entry.querySelector('published')?.textContent;
            const pdfLink = entry.querySelector('link[type="application/pdf"]')?.getAttribute('href');
            const arxivId = entry.querySelector('id')?.textContent?.split('/').pop();
            
            if (title) {
                results.push({
                    title,
                    authors: authors.join(', '),
                    year: published ? new Date(published).getFullYear() : '',
                    journal: 'arXiv preprint',
                    pdfUrl: pdfLink,
                    doiUrl: `https://arxiv.org/abs/${arxivId}`,
                    source: 'arXiv'
                });
            }
        });
        
        return results;
    } catch (error) {
        console.error('arXiv search error:', error);
        return [];
    }
}

// CrossRef API search
async function searchCrossRefAPI(query) {
    const url = `https://api.crossref.org/works?query=${encodeURIComponent(query)}&rows=10`;
    
    try {
        const response = await fetch(url);
        const data = await response.json();
        
        return data.message.items.map(item => ({
            title: item.title?.[0] || 'No title available',
            authors: item.author?.map(a => `${a.given || ''} ${a.family || ''}`).join(', ') || 'Unknown authors',
            year: item.published?.['date-parts']?.[0]?.[0] || '',
            journal: item['container-title']?.[0] || 'Unknown journal',
            pdfUrl: item.URL,
            doiUrl: item.DOI ? `https://doi.org/${item.DOI}` : '#',
            source: 'CrossRef'
        }));
    } catch (error) {
        console.error('CrossRef search error:', error);
        return [];
    }
}

// Semantic Scholar API search
async function searchSemanticScholarAPI(query) {
    const url = `https://api.semanticscholar.org/graph/v1/paper/search?query=${encodeURIComponent(query)}&limit=10&fields=title,authors,year,journal,openAccessPdf,externalIds`;
    
    try {
        const response = await fetch(url);
        const data = await response.json();
        
        return data.data.map(paper => ({
            title: paper.title || 'No title available',
            authors: paper.authors?.map(a => a.name).join(', ') || 'Unknown authors',
            year: paper.year || '',
            journal: paper.journal?.name || 'Unknown journal',
            pdfUrl: paper.openAccessPdf?.url || '#',
            doiUrl: paper.externalIds?.DOI ? `https://doi.org/${paper.externalIds.DOI}` : '#',
            source: 'Semantic Scholar'
        }));
    } catch (error) {
        console.error('Semantic Scholar search error:', error);
        return [];
    }
}

// Display search results
function displaySearchResults(results) {
    const resultsDiv = document.getElementById('paperSearchResults');
    
    if (results.length === 0) {
        resultsDiv.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-secondary);">No results found. Try different keywords.</div>';
        return;
    }
    
    resultsDiv.innerHTML = results.map(paper => `
        <div class="result-item">
            <div class="result-title">${paper.title}</div>
            <div class="result-authors">${paper.authors} (${paper.year})</div>
            <div class="result-journal">${paper.journal}</div>
            <div class="result-links">
                ${paper.pdfUrl !== '#' ? `<a href="${paper.pdfUrl}" class="result-link" target="_blank"><i class="fas fa-file-pdf"></i> PDF</a>` : ''}
                ${paper.doiUrl !== '#' ? `<a href="${paper.doiUrl}" class="result-link" target="_blank"><i class="fas fa-external-link-alt"></i> View</a>` : ''}
                <a href="#" class="result-link" onclick="copyPaperCitation('${paper.title.replace(/'/g, "\\'")}', '${paper.authors.replace(/'/g, "\\'")}', '${paper.year}')"><i class="fas fa-quote-left"></i> Cite</a>
            </div>
        </div>
    `).join('');
}

// Copy citation function
function copyPaperCitation(title, authors, year) {
    const citation = `${authors} (${year}). ${title}.`;
    navigator.clipboard.writeText(citation).then(() => {
        alert('Citation copied to clipboard!');
    });
}

// Enter key search
document.getElementById('paperSearchInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        searchResearchPapers();
    }
});
</script>
